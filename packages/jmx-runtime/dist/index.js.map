{"version":3,"file":"index.js","sources":["../base.ts","../jmx.ts","../lib.ts","../h.ts"],"sourcesContent":["export function hopsi() {}\n\nexport function rebind<T extends object>(o: T, proto = Object.getPrototypeOf(o)) : T {\n    Object.entries(Object.getOwnPropertyDescriptors(proto))\n        .filter(([name, p]) => name != 'constructor' && p.value instanceof Function)\n        .forEach(([name]) => (o as any)[name] = (o as any)[name].bind(o))\n    return o\n}\n\nexport function mount(o: Record<string, any>) { Object.assign(globalThis, o) }\n\nexport const loggedmethodsex = <T extends Record<string, any>>(o: T, logger: (name: string, args: any[], result: any) => void) => new Proxy(o, {\n    get(target, name: string, receiver) {\n        if (typeof target[name] === \"function\") {\n            return function (this: T, ...args: any[]) {\n\n                logger(name, args, undefined)\n                let r = target[name].apply(this, args)\n                return r\n            }\n        }\n        return Reflect.get(target, name, receiver)\n    },\n})\n\nexport const loggedmethods = <T extends Record<string, any>>(o: T ): T => loggedmethodsex(o, (name, args, result) => console.log(\"%c\" + name, \"background:#585059;color:white;padding:2px;font-weight:bold\", args))\nexport const loggedmethodscolored = <T extends Record<string, any>>(bgcolor: string, o: T ): T => loggedmethodsex(o, (name, args, result) => console.log(\"%c\" + name, `background:${bgcolor};color:white;padding:2px;font-weight:bold`, args))\n","import { rebind } from './base'\nimport { Expr, FComponent, H, HComp, HCompClass, HElement, HFragment, IClassComponent, Props } from './h'\n\n// config\nexport function createElement(tag: string) {\n    let ns = window.jmx?.getnamespace?.(tag)\n    return ns ? document.createElementNS(ns, tag) : document.createElement(tag)\n}\n\nconst enum NodeType { // vaporizes (but for that must be in this file, otherwise not)\n    TextNode = 3,\n}\n\nlet evaluate = <T>(expr: Expr<T>): T => (expr instanceof Function ? expr() : expr)\nlet removeexcesschildren = (n: Element, i: number) => {\n    let c: ChildNode\n    while ((c = n.childNodes[i])) {\n        c.remove()\n    }\n}\nlet iswebcomponent = (h: HElement) => (h.tag as string).includes('-')\nlet isclasscomponent = (h: HComp): h is HCompClass => (h.tag as any)?.prototype?.view\nlet iselement = (h: any): h is HElement => typeof h.tag == 'string'\nlet isfragment = (h: any): h is HFragment => {\n    return h.tag == undefined && h.cn != undefined\n}\nlet isobject = (o: any): o is object => typeof o === 'object'\n\nlet isproperty = (name: string, value: any) =>\n    ['value', 'checked', 'disabled', 'className', 'style', 'href', 'src', 'selected', 'readOnly', 'tabIndex'].includes(\n        name\n    ) ||\n    value instanceof Object ||\n    value instanceof Function\n\nlet setprops = (e: Element, newprops: Props = {}) => {\n    let oldprops = evaluate(e.h?.p) ?? {}\n    for (let p in oldprops)\n        !(p in newprops) && isproperty(p, oldprops[p]) ? ((e as any)[p] = null) : e.removeAttribute(p)\n    for (let p in newprops) isproperty(p, newprops[p]) ? ((e as any)[p] = newprops[p]) : e.setAttribute(p, newprops[p])\n}\n\n/** syncs at position i of p. returns the number of the element past the last added element.\n * if no element was added (eg when h=null) then it returns i\n * if a fragment with 5 nodes was added, it returns i + 5\n * when a single element or component is added, it is i+1 since they always create exactly 1 node\n */\nfunction sync(p: Element, i: number, h: Expr<H | undefined>): number {\n    // console.log('%csync', \"background:orange\", p.tagName, i, h)\n\n    h = evaluate(h)\n    if (h === null || h === undefined) return i // skip this element. not that !!h would forbid to render the number 0 or the boolean value false\n\n    let c = p.childNodes[i] // is often null, eg during fresh creation\n\n    function synctextnode(text: string) {\n        if (c && c.nodeType == NodeType.TextNode) {\n            if (c.textContent != text) c.textContent = text // firefox updates even equal text, loosing an existing text selection\n        } else {\n            let tn = document.createTextNode(text)\n            c ? c.replaceWith(tn) : p.appendChild(tn)\n        }\n    }\n\n    if (isobject(h)) {\n        // element nodes\n\n        /** synchronizes children starting at the i-th element. returns the index of the last child synchronized */\n        function syncchildren(p: Element, h: HElement | HComp | HFragment, i: number): number {\n            evaluate(h.cn)\n                ?.flat()\n                .forEach(hc => (i = sync(p, i, hc)))\n            return i\n        }\n\n        if (isfragment(h)) return syncchildren(p, h, i)\n\n        const props = evaluate(h.p)\n\n        if (iselement(h)) {\n            let n: Element\n\n            if ((<Element>c)?.tagName?.toLowerCase() != h.tag.toLowerCase()) {\n                n = createElement(h.tag)\n                c ? c.replaceWith(n) : p.appendChild(n)\n                setprops(n, props)\n                props?.mounted?.(n)\n            } else {\n                n = c as Element\n                setprops(n, props)\n                if (props?.update?.(c, globaluc)) return i + 1\n            }\n\n            // if only components shall be updateable (advantage: close variables inside component functions are always fresh materialized, avoids surprises), comment this out\n            n.h = h\n\n            if (!globaluc.patchElementOnly && !iswebcomponent(h as HElement)) {\n                // tbd: make \"island\" attribute\n                const j = syncchildren(n, h, 0)\n                removeexcesschildren(n, j)\n            }\n            return i + 1\n        }\n\n        switch (typeof h.tag) {\n            case 'function':\n                let isupdate = c?.h?.tag == h.tag\n\n                let ci: IClassComponent | undefined\n\n                if (isclasscomponent(h)) {\n                    h.i = ci = isupdate ? (c.h as HCompClass)?.i : rebind(new h.tag(props))\n                    ci.props = props\n\n                    // if component instance returns truthy for update(), then this update substitutes syncing\n                    if (isupdate && ci.update(globaluc)) return i + 1\n                }\n\n                // materialize the component\n                // we run compoents view() and fun code often, we do not compare properties to avoid their computation\n                // this means that the inner hr (h resolved) is run often\n                //\n                // if ci has a view, return ci.view() even if it is falsy, this is perfectly valid\n                let hr = ci?.view ? ci?.view() : (h.tag as FComponent)(props, evaluate(h.cn))\n\n                // a component can return undefined or null if it has no elements to show\n                if (hr === undefined || hr == null) return i\n\n                let j = sync(p, i, hr)\n\n                // now the dom element exists\n\n                let cn = p.childNodes[i]!\n                cn.h = h // attach h onto the materialized component node\n                // ;(cn as HTMLElement).setAttribute?.('comp', '')\n\n                // class component life cycle calls\n                if (ci) ci.element = cn\n                if (!isupdate) ci?.mounted?.()\n\n                return j\n\n            case 'object':\n                return sync(p, i, h.tag) // tbd: type of h is not correct, h.tag == never\n        }\n    }\n    // text nodes\n    synctextnode(h as string)\n    return i + 1\n}\n\nlet globaluc: IUpdateContext = {}\n\nexport function patch(e: Node | null, h: Expr<H>) {\n    if (!e) return\n    if (globaluc.replace) (e as HTMLElement).replaceChildren()\n    const p = e.parentElement as HTMLElement\n    const i = [].indexOf.call<any, any, any>(p.childNodes, e)\n    // always called deferred, because removing elements can trigger events and their handlers (like blur)\n    sync(p, i, h)\n}\n\n// Overload signatures\ntype Selector = string | Node | undefined | null\ntype Selectors = Selector[]\n\nexport function updateviewuc(uc: IUpdateContext, ...sels: Selectors): void {\n    {\n        globaluc = uc\n        updateviewinternal(...sels)\n    }\n}\nexport function updateview(...sels: Selectors): void {\n    {\n        globaluc = {}\n        updateviewinternal(...sels)\n    }\n}\n\nfunction updateviewinternal(...sels: Selector[]): void {\n    if (!sels.length) sels.push('body')\n    sels.flatMap(s => (typeof s == 'string' ? [...document.querySelectorAll(s)] : s ? [s] : [])).forEach(e => {\n        if (!e?.h) throw 'jmx: no h exists on the node'\n        patch(e, e.h)\n    })\n}\n","import { Props, IClassComponent, H, FComponentT, Children } from 'h'\nimport { updateview } from './jmx'\n\nexport type DeepReadonly<T> = { readonly [K in keyof T]: T[K] extends Record<string, unknown> ? DeepReadonly<T[K]> : T[K]; }\n\nexport const When = ({ cond }: { cond: boolean }, cn: Children) => cond ? { cn } : void 0;\n\nexport abstract class JMXComp<P extends Props = {}> implements IClassComponent {\n\n    // assigned by jmx framework\n    element!: HTMLElement\n\n    // we provide this ctor for jsx which uses ctor arguments as properties of class components.\n    // at runtime, we pass the props directly\n    constructor(public props: P) { }\n\n    // overrides\n    mounted() { }\n    update(uc?: IUpdateContext): boolean | void { }\n    abstract view(): H\n\n    // utility: updates the component's view\n    updateview() { updateview(this.element) }\n    get ismounted():boolean { return this.element as any }\n}\n\nexport function cc(...namesOrObjects: (string | any)[]): string {\n    return namesOrObjects.flatMap(n => (n.trim ? n : Object.keys(n).filter(k => n[k]))).join(' ') // n.trim distinguishes strings from objects\n}","// jmx internal types - hopst\n// the following types describe the js expression we get from tsx after conversion be our jmx plugin\n// they can be useful for users as well, components might return them.\n\ntype Func<T> = () => T\nexport type Expr<T> = T | Func<T>\n\nexport type Props = Record<string, any>\n\nexport type FComponent = (props: Props | undefined, children?: ChildrenH) => HElement // show an example for usage of children\n\nexport type FComponentT<P> = (pcn: P, cn?: Children) => H | void\n\nexport interface IClassComponent {\n    element: Node\n    props?: Record<string, any>\n    view(): H\n    update(uc: IUpdateContext): boolean | void\n    mounted?(): void\n    //new(props: any): IClassComponent\n}\n\ninterface CComponent {\n    new (props: any): IClassComponent // while a real component expresses its interface via props pass to the ctor, internally we assign props after construction with new()\n}\n\nexport type ChildrenH = (H | undefined)[]\nexport type Children = Expr<ChildrenH>\n\ntype HText =\n    | string // text node\n    | number // text node\n    | boolean // do not allow boolean, that\n\nexport type HFragment = {\n    cn: Children\n}\n\nexport type HElement = {\n    tag: string\n    p?: Expr<Props>\n    cn: Children\n    i?: any\n}\n\ntype HCompFun = {\n    tag: FComponent\n    p?: Expr<Props>\n    cn?: Children\n}\n\nexport type HCompClass = {\n    tag: CComponent\n    p?: Expr<Props>\n    cn: Children\n    i: IClassComponent\n}\n\nexport type HComp = HCompFun | HCompClass\n\nexport type H = // a hyperscript atom that describes a ...\n\n        | HText\n        | HElement // a tag, like p, div with attributes and children\n        | HComp // a dynamic component computing any other HNode\n        | HFragment\n\ndeclare global {\n    interface Node {\n        h?: HElement | HCompFun | HCompClass\n    }\n    export interface IUpdateContext {\n        patchElementOnly?: boolean\n        replace?: boolean\n    }\n\n    export interface Window {\n        jmx?: {\n            getnamespace: (tag: string) => string | undefined\n        }\n    }\n}\n\nexport function jsx(): HElement {\n    throw 'jmx plugin not configured'\n} // dumy function for app code - jmx-plugin removes calls to this function, minifyer then removes it\nexport function jsxf(): HElement {\n    throw 'jmx plugin not configured'\n} // dumy function for app code - jmx-plugin removes calls to this function, minifyer then removes it\n"],"names":[],"mappings":"AAAM,SAAU,KAAK,GAAA,EAAI;AAEnB,SAAU,MAAM,CAAmB,CAAI,EAAE,KAAK,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,EAAA;IAC3E,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,yBAAyB,CAAC,KAAK,CAAC;AACjD,SAAA,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,IAAI,IAAI,aAAa,IAAI,CAAC,CAAC,KAAK,YAAY,QAAQ;SAC1E,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,KAAM,CAAS,CAAC,IAAI,CAAC,GAAI,CAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACrE,IAAA,OAAO,CAAC;AACZ;AAEM,SAAU,KAAK,CAAC,CAAsB,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAA,CAAC;AAEtE,MAAM,eAAe,GAAG,CAAgC,CAAI,EAAE,MAAwD,KAAK,IAAI,KAAK,CAAC,CAAC,EAAE;AAC3I,IAAA,GAAG,CAAC,MAAM,EAAE,IAAY,EAAE,QAAQ,EAAA;QAC9B,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;YACpC,OAAO,UAAmB,GAAG,IAAW,EAAA;AAEpC,gBAAA,MAAM,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,CAAC;AAC7B,gBAAA,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC;AACtC,gBAAA,OAAO,CAAC;AACZ,YAAA,CAAC;QACL;QACA,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC;IAC9C,CAAC;AACJ,CAAA;AAEM,MAAM,aAAa,GAAG,CAAgC,CAAI,KAAS,eAAe,CAAC,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,KAAK,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,EAAE,6DAA6D,EAAE,IAAI,CAAC;AAC3M,MAAM,oBAAoB,GAAG,CAAgC,OAAe,EAAE,CAAI,KAAS,eAAe,CAAC,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,KAAK,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,EAAE,cAAc,OAAO,CAAA,yCAAA,CAA2C,EAAE,IAAI,CAAC;;ACtBvO,SAAU,aAAa,CAAC,GAAW,EAAA;IACrC,IAAI,EAAE,GAAG,MAAM,CAAC,GAAG,EAAE,YAAY,GAAG,GAAG,CAAC;IACxC,OAAO,EAAE,GAAG,QAAQ,CAAC,eAAe,CAAC,EAAE,EAAE,GAAG,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC;AAC/E;AAMA,IAAI,QAAQ,GAAG,CAAI,IAAa,MAAS,IAAI,YAAY,QAAQ,GAAG,IAAI,EAAE,GAAG,IAAI,CAAC;AAClF,IAAI,oBAAoB,GAAG,CAAC,CAAU,EAAE,CAAS,KAAI;AACjD,IAAA,IAAI,CAAY;IAChB,QAAQ,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG;QAC1B,CAAC,CAAC,MAAM,EAAE;IACd;AACJ,CAAC;AACD,IAAI,cAAc,GAAG,CAAC,CAAW,KAAM,CAAC,CAAC,GAAc,CAAC,QAAQ,CAAC,GAAG,CAAC;AACrE,IAAI,gBAAgB,GAAG,CAAC,CAAQ,KAAuB,CAAC,CAAC,GAAW,EAAE,SAAS,EAAE,IAAI;AACrF,IAAI,SAAS,GAAG,CAAC,CAAM,KAAoB,OAAO,CAAC,CAAC,GAAG,IAAI,QAAQ;AACnE,IAAI,UAAU,GAAG,CAAC,CAAM,KAAoB;IACxC,OAAO,CAAC,CAAC,GAAG,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,IAAI,SAAS;AAClD,CAAC;AACD,IAAI,QAAQ,GAAG,CAAC,CAAM,KAAkB,OAAO,CAAC,KAAK,QAAQ;AAE7D,IAAI,UAAU,GAAG,CAAC,IAAY,EAAE,KAAU,KACtC,CAAC,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC,QAAQ,CAC9G,IAAI,CACP;AACD,IAAA,KAAK,YAAY,MAAM;IACvB,KAAK,YAAY,QAAQ;AAE7B,IAAI,QAAQ,GAAG,CAAC,CAAU,EAAE,QAAA,GAAkB,EAAE,KAAI;AAChD,IAAA,IAAI,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE;IACrC,KAAK,IAAI,CAAC,IAAI,QAAQ;AAClB,QAAA,EAAE,CAAC,IAAI,QAAQ,CAAC,IAAI,UAAU,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAK,CAAS,CAAC,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;IAClG,KAAK,IAAI,CAAC,IAAI,QAAQ;AAAE,QAAA,UAAU,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAK,CAAS,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;AACvH,CAAC;AAOD,SAAS,IAAI,CAAC,CAAU,EAAE,CAAS,EAAE,CAAsB,EAAA;AAGvD,IAAA,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;AACf,IAAA,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,SAAS;AAAE,QAAA,OAAO,CAAC;IAE3C,IAAI,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;IAEvB,SAAS,YAAY,CAAC,IAAY,EAAA;AAC9B,QAAA,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,IAAA,CAAqB,EAAE;AACtC,YAAA,IAAI,CAAC,CAAC,WAAW,IAAI,IAAI;AAAE,gBAAA,CAAC,CAAC,WAAW,GAAG,IAAI;QACnD;aAAO;YACH,IAAI,EAAE,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC;AACtC,YAAA,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC;QAC7C;IACJ;AAEA,IAAA,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;AAIb,QAAA,SAAS,YAAY,CAAC,CAAU,EAAE,CAA+B,EAAE,CAAS,EAAA;AACxE,YAAA,QAAQ,CAAC,CAAC,CAAC,EAAE;AACT,kBAAE,IAAI;AACL,iBAAA,OAAO,CAAC,EAAE,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;AACxC,YAAA,OAAO,CAAC;QACZ;QAEA,IAAI,UAAU,CAAC,CAAC,CAAC;YAAE,OAAO,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAE/C,MAAM,KAAK,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AAE3B,QAAA,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;AACd,YAAA,IAAI,CAAU;AAEd,YAAA,IAAc,CAAE,EAAE,OAAO,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE;AAC7D,gBAAA,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC;AACxB,gBAAA,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;AACvC,gBAAA,QAAQ,CAAC,CAAC,EAAE,KAAK,CAAC;AAClB,gBAAA,KAAK,EAAE,OAAO,GAAG,CAAC,CAAC;YACvB;iBAAO;gBACH,CAAC,GAAG,CAAY;AAChB,gBAAA,QAAQ,CAAC,CAAC,EAAE,KAAK,CAAC;gBAClB,IAAI,KAAK,EAAE,MAAM,GAAG,CAAC,EAAE,QAAQ,CAAC;oBAAE,OAAO,CAAC,GAAG,CAAC;YAClD;AAGA,YAAA,CAAC,CAAC,CAAC,GAAG,CAAC;YAEP,IAAI,CAAC,QAAQ,CAAC,gBAAgB,IAAI,CAAC,cAAc,CAAC,CAAa,CAAC,EAAE;gBAE9D,MAAM,CAAC,GAAG,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AAC/B,gBAAA,oBAAoB,CAAC,CAAC,EAAE,CAAC,CAAC;YAC9B;YACA,OAAO,CAAC,GAAG,CAAC;QAChB;AAEA,QAAA,QAAQ,OAAO,CAAC,CAAC,GAAG;AAChB,YAAA,KAAK,UAAU;gBACX,IAAI,QAAQ,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,CAAC,GAAG;AAEjC,gBAAA,IAAI,EAA+B;AAEnC,gBAAA,IAAI,gBAAgB,CAAC,CAAC,CAAC,EAAE;oBACrB,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,QAAQ,GAAI,CAAC,CAAC,CAAgB,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACvE,oBAAA,EAAE,CAAC,KAAK,GAAG,KAAK;AAGhB,oBAAA,IAAI,QAAQ,IAAI,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC;wBAAE,OAAO,CAAC,GAAG,CAAC;gBACrD;AAOA,gBAAA,IAAI,EAAE,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,IAAI,EAAE,GAAI,CAAC,CAAC,GAAkB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;AAG7E,gBAAA,IAAI,EAAE,KAAK,SAAS,IAAI,EAAE,IAAI,IAAI;AAAE,oBAAA,OAAO,CAAC;gBAE5C,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBAItB,IAAI,EAAE,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAE;AACzB,gBAAA,EAAE,CAAC,CAAC,GAAG,CAAC;AAIR,gBAAA,IAAI,EAAE;AAAE,oBAAA,EAAE,CAAC,OAAO,GAAG,EAAE;AACvB,gBAAA,IAAI,CAAC,QAAQ;AAAE,oBAAA,EAAE,EAAE,OAAO,IAAI;AAE9B,gBAAA,OAAO,CAAC;AAEZ,YAAA,KAAK,QAAQ;gBACT,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC;;IAEpC;IAEA,YAAY,CAAC,CAAW,CAAC;IACzB,OAAO,CAAC,GAAG,CAAC;AAChB;AAEA,IAAI,QAAQ,GAAmB,EAAE;AAE3B,SAAU,KAAK,CAAC,CAAc,EAAE,CAAU,EAAA;AAC5C,IAAA,IAAI,CAAC,CAAC;QAAE;IACR,IAAI,QAAQ,CAAC,OAAO;QAAG,CAAiB,CAAC,eAAe,EAAE;AAC1D,IAAA,MAAM,CAAC,GAAG,CAAC,CAAC,aAA4B;AACxC,IAAA,MAAM,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAgB,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC;AAEzD,IAAA,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AACjB;SAMgB,YAAY,CAAC,EAAkB,EAAE,GAAG,IAAe,EAAA;IAC/D;QACI,QAAQ,GAAG,EAAE;AACb,QAAA,kBAAkB,CAAC,GAAG,IAAI,CAAC;IAC/B;AACJ;AACM,SAAU,UAAU,CAAC,GAAG,IAAe,EAAA;IACzC;QACI,QAAQ,GAAG,EAAE;AACb,QAAA,kBAAkB,CAAC,GAAG,IAAI,CAAC;IAC/B;AACJ;AAEA,SAAS,kBAAkB,CAAC,GAAG,IAAgB,EAAA;IAC3C,IAAI,CAAC,IAAI,CAAC,MAAM;AAAE,QAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;IACnC,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK,OAAO,CAAC,IAAI,QAAQ,GAAG,CAAC,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,IAAG;QACrG,IAAI,CAAC,CAAC,EAAE,CAAC;AAAE,YAAA,MAAM,8BAA8B;AAC/C,QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB,IAAA,CAAC,CAAC;AACN;;ACpLO,MAAM,IAAI,GAAG,CAAC,EAAE,IAAI,EAAqB,EAAE,EAAY,KAAK,IAAI,GAAG,EAAE,EAAE,EAAE,GAAG;MAE7D,OAAO,CAAA;AAON,IAAA,KAAA;AAJnB,IAAA,OAAO;AAIP,IAAA,WAAA,CAAmB,KAAQ,EAAA;QAAR,IAAA,CAAA,KAAK,GAAL,KAAK;IAAO;AAG/B,IAAA,OAAO,KAAK;IACZ,MAAM,CAAC,EAAmB,EAAA,EAAoB;IAI9C,UAAU,GAAA,EAAK,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA,CAAC;IACxC,IAAI,SAAS,KAAa,OAAO,IAAI,CAAC,OAAc,CAAA,CAAC;AACxD;AAEK,SAAU,EAAE,CAAC,GAAG,cAAgC,EAAA;IAClD,OAAO,cAAc,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;AACjG;;SCuDgB,GAAG,GAAA;AACf,IAAA,MAAM,2BAA2B;AACrC;SACgB,IAAI,GAAA;AAChB,IAAA,MAAM,2BAA2B;AACrC;;;;"}