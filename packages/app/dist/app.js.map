{"version":3,"file":"app.js","sources":["../../jmx-runtime/dist/base.js","../../jmx-runtime/dist/jmx.js"],"sourcesContent":["export function rebind(o) {\n    Object.entries(Object.getOwnPropertyDescriptors(Object.getPrototypeOf(o)))\n        .filter(([name, p]) => name != 'constructor' && p.value instanceof Function)\n        .forEach(([name]) => o[name] = o[name].bind(o));\n    return o;\n}\nexport function mount(o) { Object.assign(globalThis, o); }\nexport const loggedmethodsex = (o, logger) => new Proxy(o, {\n    get(target, name, receiver) {\n        if (typeof target[name] === \"function\") {\n            return function (...args) {\n                logger(name, args, undefined);\n                let r = target[name].apply(this, args);\n                return r;\n            };\n        }\n        return Reflect.get(target, name, receiver);\n    },\n});\nexport const loggedmethods = (o) => loggedmethodsex(o, (name, args, result) => console.log(\"%c\" + name, \"background:#585059;color:white;padding:2px;font-weight:bold\", args));\nexport const loggedmethodscolored = (bgcolor, o) => loggedmethodsex(o, (name, args, result) => console.log(\"%c\" + name, `background:${bgcolor};color:white;padding:2px;font-weight:bold`, args));\n//# sourceMappingURL=base.js.map","import { rebind } from './base';\nlet evaluate = (expr) => (expr instanceof Function ? expr() : expr);\nlet removeexcesschildren = (n, i) => {\n    let c;\n    while ((c = n.childNodes[i])) {\n        c.remove();\n    }\n};\nlet iswebcomponent = (h) => h.tag.includes('-');\nlet isclasscomponent = (h) => h.tag?.prototype?.view;\nlet iselement = (h) => typeof h.tag == 'string';\nlet isfragment = (h) => {\n    return h.tag == undefined && h.cn != undefined;\n};\nlet isobject = (o) => typeof o === 'object';\nlet isproperty = (name, value) => ['value', 'checked', 'disabled', 'className', 'style', 'href', 'src', 'selected', 'readOnly', 'tabIndex'].includes(name) ||\n    value instanceof Object ||\n    value instanceof Function;\nlet setprops = (e, newprops = {}) => {\n    let oldprops = evaluate(e.h?.p) ?? {};\n    for (let p in oldprops)\n        !(p in newprops) && isproperty(p, oldprops[p]) ? (e[p] = null) : e.removeAttribute(p);\n    for (let p in newprops)\n        isproperty(p, newprops[p]) ? (e[p] = newprops[p]) : e.setAttribute(p, newprops[p]);\n};\nfunction sync(p, i, h, uc) {\n    h = evaluate(h);\n    if (h === null || h === undefined)\n        return i;\n    let c = p.childNodes[i];\n    function synctextnode(text) {\n        if (c && c.nodeType == 3) {\n            if (c.textContent != text)\n                c.textContent = text;\n        }\n        else {\n            let tn = document.createTextNode(text);\n            c ? c.replaceWith(tn) : p.appendChild(tn);\n        }\n    }\n    if (isobject(h)) {\n        function syncchildren(p, h, i) {\n            evaluate(h.cn)\n                ?.flat()\n                .forEach(hc => (i = sync(p, i, hc, uc)));\n            return i;\n        }\n        if (isfragment(h))\n            return syncchildren(p, h, i);\n        const props = evaluate(h.p);\n        if (iselement(h)) {\n            let n;\n            if (c?.tagName != h.tag) {\n                n = document.createElement(h.tag);\n                c ? c.replaceWith(n) : p.appendChild(n);\n                setprops(n, props);\n                props?.mounted?.(n);\n            }\n            else {\n                n = c;\n                setprops(n, props);\n                if (props?.update?.(c, uc))\n                    return i + 1;\n            }\n            console.log(\"n.h = \", h);\n            n.h = h;\n            if (!uc.patchElementOnly && !iswebcomponent(h)) {\n                const j = syncchildren(n, h, 0);\n                removeexcesschildren(n, j);\n            }\n            return i + 1;\n        }\n        switch (typeof h.tag) {\n            case 'function':\n                let isupdate = c?.h?.tag == h.tag;\n                let ci;\n                if (isclasscomponent(h)) {\n                    h.i = ci = c?.h?.i ?? rebind(new h.tag(props));\n                    ci.props = props;\n                    if (isupdate && ci.update(uc))\n                        return i + 1;\n                }\n                let hr = ci?.view() ?? h.tag(props, evaluate(h.cn));\n                if (hr === undefined || hr == null)\n                    return i;\n                let j = sync(p, i, hr, uc);\n                let cn = p.childNodes[i];\n                cn.h = h;\n                if (ci)\n                    ci.element = cn;\n                if (!isupdate)\n                    ci?.mounted();\n                return j;\n            case 'object':\n                return sync(p, i, h.tag, uc);\n        }\n    }\n    synctextnode(h);\n    return i + 1;\n}\nexport function patch(e, h, uc = {}) {\n    if (!e)\n        return;\n    if (uc.replace)\n        e.replaceChildren();\n    const p = e.parentElement;\n    const i = [].indexOf.call(p.childNodes, e);\n    requestAnimationFrame(() => sync(p, i, h, uc));\n}\nexport function updateview(...ucOrSelectors) {\n    {\n        let uc;\n        ucOrSelectors\n            .flatMap(x => typeof x == 'string' ? [...document.querySelectorAll(x)] : x instanceof Node ? [x] : ((uc = x), []))\n            .forEach(e => {\n            if (!e?.h)\n                throw 'jmx: no h exists on the node';\n            patch(e, e.h, uc);\n        });\n    }\n}\nexport function jsx() {\n    throw 'jmx plugin not configured';\n}\nexport function jsxf() {\n    throw 'jmx plugin not configured';\n}\n//# sourceMappingURL=jmx.js.map"],"names":[],"mappings":"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"}