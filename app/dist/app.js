function h(e){Object.assign(globalThis,e)}function w(e){Object.assign(globalThis,e)}function x(e,...t){let o=Object.getOwnPropertyDescriptors(e.prototype);delete o.constructor,t.forEach(n=>Object.defineProperties(n.prototype,o)),o=Object.getOwnPropertyDescriptors(e),Object.entries(o).forEach(([n,c])=>!c.writable&&delete o[n]),t.forEach(n=>Object.defineProperties(n,o))}x(class extends Object{log(e){return console.log(e,this),w({x:this}),this}},Object);function p(e,t={}){let o=r=>{g(r,t[r])?e[r]=t[r]:e.setAttribute(r,t[r])},n=r=>{g(r,c[r])?e[r]=null:e.removeAttribute(r)},c=s(e.h?.props)??{};for(let r in c)!(r in t)&&n(r);for(let r in t)o(r)}function g(e,t){return["value","checked","disabled","className","style","href","src","selected","readOnly","tabIndex"].includes(e)||t instanceof Object||t instanceof Function}function E(e){let t=Object.getPrototypeOf(e),o=Object.entries(Object.getOwnPropertyDescriptors(t)).filter(([,n])=>n.value instanceof Function).filter(([n])=>n!="constructor").map(([n])=>n);for(const n of o)e[n]=e[n].bind(e);return e}let N=(e,t)=>{console.log("removeexcesschildren",e.tagName,t);let o;for(;o=e.childNodes[t];)o.remove()},P=e=>e.tag.includes("-");const s=e=>e instanceof Function?s(e()):e;let C=e=>e.tag?.prototype?.view;function d(e,t,o,n){if(o==null)return t;o=s(o);const c=s(o.props),r=e.childNodes[t];function a(i){if(r&&r.nodeType==3)r.textContent!=i&&(r.textContent=i);else{const l=document.createTextNode(i);r?r.replaceWith(l):e.appendChild(l)}}function v(i){if(r?.tagName!=i){const l=document.createElement(i);return r?r.replaceWith(l):e.appendChild(l),p(l,c),c?.mounted?.(l),l}else return p(r,c),c?.update?.(n),r}function j(i,l){if(C(i)){let u=(l?.h).i??=E(new i.tag(c));return u.props=c,u.view()}else return i.tag(c,s(i.children))}switch(typeof o){case"string":case"number":case"boolean":return a(o),t+1;case"object":switch(typeof o.tag){case"function":return d(e,t,j(o,r),n);case"string":let i=v(o.tag);if(!n.patchElementOnly&&!P(o)){const l=D(i,o,0,n);N(i,l)}return t+1}}throw"invalid execution - code is wrong"}let m=e=>e.tag==null&&e.children!=null,b=e=>e.tag instanceof Function&&e.children==null&&e.props==null;function y(e){return(s(e.children)??[]).log("children").flatMap(t=>b(t)?s(s(t.tag).children):t).flatMap(t=>t.tag&&m(t.tag)?s(t?.tag?.children):t).filter(t=>t!=null)}h({isfragment:m,isfragment2:b,getchildren:y,evaluate:s});function D(e,t,o,n){return y(t).forEach(c=>{let r=o;o=d(e,o,c,n);let a=e.childNodes[r];a&&!a.h&&(a.h=c)}),o}function f(e,t,o={}){const n=e.parentElement,c=[].indexOf.call(n.childNodes,e);d(n,c,t,o),e.h=t}function F(e="body",t={}){const o=typeof e=="string"?document.querySelectorAll(e):[e];let n;for(n of o){for(;n&&!n.h;)n=n.parentElement;if(n){if(t.replace&&n.replaceChildren(),!n.h)throw["cannot update, because html was not created with jmx: no h exists on the node",n];f(n,n.h,t)}}}let A={kind:"fragment",children:()=>["aa","bb"]},O={tag:"BODY",children:()=>[{tag:A},{tag:"DIV"}]};h({u:F,patch:f,App3:O});f(document.body,O);
