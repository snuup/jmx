function d(e){Object.assign(globalThis,e)}function w(e){Object.assign(globalThis,e)}function x(e,...t){let o=Object.getOwnPropertyDescriptors(e.prototype);delete o.constructor,t.forEach(n=>Object.defineProperties(n.prototype,o)),o=Object.getOwnPropertyDescriptors(e),Object.entries(o).forEach(([n,r])=>!r.writable&&delete o[n]),t.forEach(n=>Object.defineProperties(n,o))}x(class extends Object{log(e){return console.log(e,this),w({x:this}),this}},Object);function g(e,t={}){let o=c=>{m(c,t[c])?e[c]=t[c]:e.setAttribute(c,t[c])},n=c=>{m(c,r[c])?e[c]=null:e.removeAttribute(c)},r=s(e.h?.props)??{};for(let c in r)!(c in t)&&n(c);for(let c in t)o(c)}function m(e,t){return["value","checked","disabled","className","style","href","src","selected","readOnly","tabIndex"].includes(e)||t instanceof Object||t instanceof Function}function E(e){let t=Object.getPrototypeOf(e),o=Object.entries(Object.getOwnPropertyDescriptors(t)).filter(([,n])=>n.value instanceof Function).filter(([n])=>n!="constructor").map(([n])=>n);for(const n of o)e[n]=e[n].bind(e);return e}let N=(e,t)=>{console.log("removeexcesschildren",e.tagName,t);let o;for(;o=e.childNodes[t];)o.remove()},P=e=>e.tag.includes("-");const s=e=>e instanceof Function?s(e()):e;let C=e=>e.tag?.prototype?.view;function f(e,t,o,n){if(o==null)return t;o=s(o);const r=s(o.props),c=e.childNodes[t];function a(i){if(c&&c.nodeType==3)c.textContent!=i&&(c.textContent=i);else{const l=document.createTextNode(i);c?c.replaceWith(l):e.appendChild(l)}}function v(i){if(c?.tagName!=i){const l=document.createElement(i);return c?c.replaceWith(l):e.appendChild(l),g(l,r),r?.mounted?.(l),l}else return g(c,r),r?.update?.(n),c}function j(i,l){if(C(i)){let p=(l?.h).i??=E(new i.tag(r));return p.props=r,p.view()}else return i.tag(r,s(i.children))}switch(typeof o){case"string":case"number":case"boolean":return a(o),t+1;case"object":switch(typeof o.tag){case"function":return f(e,t,j(o,c),n);case"string":let i=v(o.tag);if(!n.patchElementOnly&&!P(o)){const l=k(i,o,0,n);N(i,l)}return t+1}}throw"invalid execution - code is wrong"}let h=e=>e.tag==null&&e.children!=null,b=e=>e.tag instanceof Function&&e.children==null&&e.props==null;function y(e){return(s(e.children)??[]).log("children").flatMap(t=>b(t)?s(s(t.tag).children):t).flatMap(t=>t.tag&&h(t.tag)?s(t?.tag?.children):t).filter(t=>t!=null)}d({isfragment:h,isfragment2:b,getchildren:y,evaluate:s});function k(e,t,o,n){return y(t).forEach(r=>{let c=o;o=f(e,o,r,n);let a=e.childNodes[c];a&&!a.h&&(a.h=r)}),o}function u(e,t,o={}){const n=e.parentElement,r=[].indexOf.call(n.childNodes,e);f(n,r,t,o),e.h=t}function D(e="body",t={}){const o=typeof e=="string"?document.querySelectorAll(e):[e];let n;for(n of o){for(;n&&!n.h;)n=n.parentElement;if(n){if(t.replace&&n.replaceChildren(),!n.h)throw["cannot update, because html was not created with jmx: no h exists on the node",n];u(n,n.h,t)}}}let F={i:10};d({m:F});let A={kind:"fragment",children:()=>["aa","bb"]},O={kind:"component",tag:"BODY",children:()=>[{kind:"component",tag:A},{kind:"component",tag:"DIV"}]};d({u:D,patch:u,App3:O});u(document.body,O);
